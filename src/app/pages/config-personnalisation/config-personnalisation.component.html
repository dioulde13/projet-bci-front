<div class="preview-img overflow-hidden">
  <div class="swiper-container">
    <div class="swiper-wrapper preview-thumb">
      <div class="swiper-slide">
        <div
          class="slide-bg"
          style="
            background-image: url(assets/img/images-bci/flyers-bci_internet-banking_3.jpg?h=81d6463f975795c60d5fc7a9405ce9e8);
          "
        ></div>
      </div>
    </div>
  </div>
</div>
<div class="coming-content min-vh-100 py-4 px-3 py-sm-5">
  <div class="bg-primary bg-overlay"></div>
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-12 bg-body">
        <div class="d-flex auth-full-page-content p-sm-5 p-4">
          <div class="w-100">
            <div class="d-flex flex-column h-100">
              <div class="text-center mb-2 mb-md-3">
                <a class="d-block auth-logo" href="index.html"
                  ><img
                    class="img-fluid"
                    src="assets/img/logos/LOGO%20BCI%20-%20Internet%20Banking.svg?h=7e87f9d72e96197b57f9b69046cee031"
                    alt=""
                    height="100"
                    width="100"
                /></a>
              </div>
              <div class="my-auto auth-content">
                <div class="text-center mb-3">
                  <h5 class="mb-0">
                    Souscription √†<span class="fw-semibold ms-2"
                      >BCI Online</span
                    >
                  </h5>
                </div>
                <div class="text-center">
                  <h4 class="fw-semibold lh-lg mb-0">
                    Configuration et Personnalisation
                  </h4>
                </div>
                <div class="text-center mb-4">
                  <p class="text-center text-muted">
                    Personnalisez les r√¥les, les validateurs, les permissions et
                    les param√®tres de s√©curit√© pour votre entreprise.
                  </p>
                </div>

                <div class="wizard-steps">
                  <div
                    class="wizard-step"
                    *ngFor="let step of [1, 2, 3, 4, 5, 6]"
                    [class.active]="currentStep === step"
                    [class.disabled]="!stepsEnabled[step]"
                    [attr.data-step]="step"
                    (click)="goToStep(step)"
                    style="cursor: pointer"
                  >
                    <div class="wizard-step-number">
                      <span>{{ step }}</span>
                    </div>
                    <p>
                      {{
                        step === 1
                          ? "Comptes"
                          : step === 2
                          ? "Validation"
                          : step === 3
                          ? "Cat√©gories"
                          : step === 4
                          ? "S√©curit√©"
                          : step === 5
                          ? "Lien"
                          : "R√©sum√©"
                      }}
                    </p>
                  </div>
                </div>

                <div class="card-section" id="wizardContent">
                  <div
                    class="wizard-step-content"
                    *ngIf="currentStep === 1"
                    data-step="1"
                  >
                    <div class="card border-0">
                      <div class="card-header">
                        <h5 class="text-body section-title">
                          S√©lection des Comptes Bancaires
                        </h5>
                        <p class="form-help">
                          Cochez les comptes que vous souhaitez g√©rer.
                        </p>
                      </div>

                      <div class="card-body">
                        <div *ngFor="let compte of comptes" class="compte-card">
                          <input
                            class="input-checkbox"
                            type="checkbox"
                            [(ngModel)]="compte.isChecked"
                            (ngModelChange)="onCheckChange(compte)"
                          />
                          <b class="compte">Compte - {{ compte.compte }}</b
                          ><br />
                          <small>
                            Type : {{ compte.typ }} | Devise :
                            {{ compte.devise }} | Solde :
                            {{ formatMontant(compte.posdisp) }}
                          </small>
                        </div>
                      </div>

                      <div class="card-footer">
                        <div class="mb-3">
                          <strong>Comptes s√©lectionn√©s :</strong>
                          <ul
                            *ngIf="
                              comptesSelectionnes.length > 0;
                              else aucunCompte
                            "
                          >
                            <li *ngFor="let compte of comptesSelectionnes">
                              ‚úÖ Compte: {{ compte.compte }} Type :
                              {{ compte.typ }} | Devise : {{ compte.devise }} |
                              Solde : {{ formatMontant(compte.posdisp) }}
                            </li>
                          </ul>
                          <ng-template #aucunCompte>
                            <p>Aucun compte s√©lectionn√©.</p>
                          </ng-template>
                        </div>
                      </div>

                      <div class="card-footer">
                        <div class="d-flex justify-content-between">
                          <div></div>
                          <div class="d-flex gap-2">
                            <button
                              class="btn btn-outline-secondary hover-animate"
                              (click)="retirerCompte()"
                            >
                              <i class="bi bi-dash-square"></i> Retirer un
                              compte
                            </button>

                            <button
                              class="btn btn-primary hover-animate"
                              [disabled]="comptesSelectionnes.length === 0"
                              (click)="nextStep()"
                            >
                              Suivant <i class="bi bi-arrow-right"></i>
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div
                    *ngIf="showCategorieRetirerModal"
                    class="modal fade show d-block"
                    tabindex="-1"
                    role="dialog"
                  >
                    <div
                      class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-sm"
                      role="document"
                    >
                      <div
                        class="modal-content"
                        style="max-height: 80vh; overflow-y: auto"
                      >
                        <div class="modal-header">
                          <h5 class="modal-title">Confirmation</h5>
                          <button
                            type="button"
                            (click)="closeCategorieRetirerModal()"
                            class="btn-close"
                            aria-label="Close"
                          ></button>
                        </div>

                        <div class="modal-body">
                          <p class="mb-0">
                            Voulez-vous vraiment <strong>retirer</strong> la
                            cat√©gorie
                            <strong>{{ categorieRetirerSupprimer?.id }}</strong>
                            ?
                          </p>
                        </div>

                        <div class="modal-footer">
                          <button
                            class="btn btn-secondary"
                            (click)="closeCategorieRetirerModal()"
                          >
                            Non
                          </button>
                          <button
                            class="btn btn-danger"
                            (click)="confirmerSuppressionCategorie()"
                          >
                            Oui
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div
                    *ngIf="showNiveauRetirerModal"
                    class="modal fade show d-block"
                    tabindex="-1"
                    role="dialog"
                  >
                    <div
                      class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-sm"
                      role="document"
                    >
                      <div
                        class="modal-content"
                        style="max-height: 80vh; overflow-y: auto"
                      >
                        <div class="modal-header">
                          <h5 class="modal-title">Confirmation</h5>
                          <button
                            type="button"
                            (click)="closeNiveauRetirerModal()"
                            class="btn-close"
                            aria-label="Close"
                          ></button>
                        </div>

                        <!-- üîî Message -->
                        <div class="modal-body">
                          <p class="mb-0">
                            Voulez-vous vraiment <strong>retirer</strong> le
                            niveau <strong>{{ niveauASupprimer?.id }}</strong> ?
                          </p>
                        </div>

                        <!-- üéØ Actions -->
                        <div class="modal-footer">
                          <button
                            class="btn btn-secondary"
                            (click)="closeNiveauRetirerModal()"
                          >
                            Non
                          </button>
                          <button
                            class="btn btn-danger"
                            (click)="confirmerSuppressionNiveau()"
                          >
                            Oui
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div
                    class="wizard-step-content"
                    *ngIf="currentStep === 2"
                    data-step="2"
                  >
                    <div class="card border-0">
                      <div class="card-header">
                        <h5 class="section-title">
                          Configuration Validation Multi-niveaux
                        </h5>
                        <p class="form-help">
                          Activez et configurez plusieurs niveaux de validation.
                        </p>
                      </div>
                      <div class="card-body">
                        <div class="form-check form-check-inline mb-3">
                          <input
                            type="radio"
                            class="form-check-input"
                            id="multiYes"
                            name="multiNiveaux"
                            [value]="true"
                            [(ngModel)]="validationConfigured"
                          />
                          <label class="form-check-label" for="multiYes"
                            >Oui</label
                          >
                        </div>
                        <div class="form-check form-check-inline mb-3">
                          <input
                            type="radio"
                            class="form-check-input"
                            id="multiNo"
                            name="multiNiveaux"
                            [(ngModel)]="validationConfigured"
                            [value]="false"
                            checked
                          />
                          <label class="form-check-label" for="multiNo"
                            >Non</label
                          >
                        </div>
                        <div *ngIf="validationConfigured" id="validationConfig">
                          <div class="container mt-4">
                            <h4>Liste des Niveaux</h4>
                            <table class="table table-bordered">
                              <thead class="table-primary">
                                <tr>
                                  <th>Niveau</th>
                                  <th>R√¥le</th>
                                  <th>Description</th>
                                  <th>Montant limite</th>
                                  <th>Actions</th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr *ngFor="let niveau of niveaux">
                                  <td>Niveau {{ niveau.niveau }}</td>
                                  <td>{{ niveau.vcRoleName }}</td>
                                  <td>{{ niveau.vcDescription }}</td>
                                  <td>
                                    {{ niveau.min | gnfFormat }} -
                                    {{ niveau.max | gnfFormat }}
                                  </td>
                                  <td>
                                    <button
                                      class="btn btn-outline-primary btn-sm"
                                      style="margin-right: 10px"
                                      (click)="openEditModal(niveau)"
                                    >
                                      Modifier
                                    </button>
                                    <button
                                      class="btn btn-outline-danger btn-sm"
                                      (click)="openNiveauRetirerModal(niveau)"
                                    >
                                      Retirer
                                    </button>
                                  </td>
                                </tr>
                              </tbody>
                            </table>

                            <button
                              class="btn btn-primary mt-2"
                              (click)="openAddModal()"
                            >
                              Ajouter un niveau
                            </button>

                            <!-- <button
                              class="btn btn-outline-secondary mt-2"
                              (click)="openAddModal()"
                            >
                              Ajouter un niveau
                            </button> -->
                          </div>

                          <dialog id="niveauModal" class="dialog">
                            <form
                              [formGroup]="niveauForm"
                              (ngSubmit)="saveNiveau()"
                            >
                              <div class="mb-3">
                                <label>R√¥le</label>
                                <select
                                  formControlName="vcRoleName"
                                  class="form-control"
                                >
                                  <option value="">
                                    -- S√©lectionner un r√¥le --
                                  </option>
                                  <option
                                    *ngFor="let role of listeRoleNiveau"
                                    [value]="role.id"
                                  >
                                    {{ role.vcRoleName }}
                                  </option>
                                </select>
                                <!-- Message d'erreur -->
                                <div
                                  *ngIf="
                                    niveauForm.get('vcRoleName')?.touched &&
                                    niveauForm.get('vcRoleName')?.invalid
                                  "
                                  class="text-danger"
                                >
                                  Veuillez s√©lectionner un r√¥le.
                                </div>
                              </div>
                              <div>
                                <label>Description</label>
                                <input
                                  type="text"
                                  formControlName="vcDescription"
                                  class="form-control me-2"
                                  placeholder="Description"
                                />
                              </div>
                              <div class="mb-3">
                                <label>Plafond financier (GNF)</label>
                                <div class="d-flex">
                                  <input
                                    type="text"
                                    formControlName="min"
                                    gnfNumberFormat
                                    class="form-control me-2"
                                    placeholder="Min"
                                  />
                                  <input
                                    type="text"
                                    formControlName="max"
                                    gnfNumberFormat
                                    class="form-control"
                                    placeholder="Max"
                                  />
                                </div>
                                <div
                                  *ngIf="
                                    niveauForm.get('min')?.touched &&
                                    niveauForm.get('min')?.invalid
                                  "
                                  class="text-danger"
                                >
                                  Veuillez saisir un montant minimum valide.
                                </div>
                                <div
                                  *ngIf="
                                    niveauForm.get('max')?.touched &&
                                    niveauForm.get('max')?.invalid
                                  "
                                  class="text-danger"
                                >
                                  Veuillez saisir un montant maximum valide.
                                </div>
                              </div>

                              <div class="mt-3">
                                <button
                                  type="submit"
                                  class="btn btn-primary me-2"
                                  [disabled]="niveauForm.invalid"
                                >
                                  Enregistrer
                                </button>
                                <button
                                  type="button"
                                  class="btn btn-secondary"
                                  (click)="closeModal()"
                                >
                                  Annuler
                                </button>
                              </div>
                            </form>
                          </dialog>
                        </div>
                      </div>
                      <div class="card-footer">
                        <div class="d-flex justify-content-between mt-4">
                          <button
                            class="btn btn-outline-secondary hover-animate"
                            (click)="prevStep()"
                          >
                            <i class="bi bi-arrow-left"></i> Pr√©c√©dent
                          </button>
                          <button
                            class="btn btn-primary hover-animate"
                            [disabled]="!canGoNextStep2()"
                            (click)="nextStep()"
                          >
                            Suivant <i class="bi bi-arrow-right"></i>
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div
                    class="wizard-step-content"
                    *ngIf="currentStep === 3"
                    data-step="3"
                  >
                    <div class="card border-0">
                      <div class="card-header">
                        <h5 class="section-title">Cat√©gories de Paiements</h5>
                        <p class="form-help">
                          G√©rez les cat√©gories et leurs r√®gles d‚Äôapprobation.
                        </p>
                      </div>
                      <div class="card-body">
                        <table class="table table-bordered">
                          <thead class="table-primary">
                            <tr>
                              <th style="width: 10%">Id</th>
                              <th>Cat√©gorie</th>
                              <th>Description</th>
                              <th style="width: 20%">Actions</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr *ngFor="let categorie of categories">
                              <td style="width: 10%">{{ categorie.id }}</td>
                              <td>{{ categorie.categorie }}</td>
                              <td>{{ categorie.description }}</td>
                              <td style="width: 20%">
                                <div class="d-flex flex-wrap gap-2">
                                  <button
                                    class="btn btn-outline-secondary"
                                    (click)="openEditCategorieModal(categorie)"
                                  >
                                    Modifier
                                  </button>
                                  <button
                                    class="btn btn-outline-danger"
                                    (click)="
                                      openCategorieRetirerModal(categorie)
                                    "
                                  >
                                    Retirer
                                  </button>
                                </div>
                              </td>
                            </tr>
                          </tbody>
                        </table>

                        <button
                          class="btn btn-primary mt-2"
                          (click)="openAddCategorieModal()"
                        >
                          <i class="bi bi-plus-square"></i> Ajouter une
                          cat√©gorie
                        </button>
                      </div>

                      <div class="card-footer">
                        <div class="d-flex justify-content-between mt-4">
                          <button
                            class="btn btn-outline-secondary hover-animate"
                            (click)="prevStep()"
                          >
                            <i class="bi bi-arrow-left"></i> Pr√©c√©dent
                          </button>
                          <button
                            class="btn btn-primary hover-animate"
                            [disabled]="!canGoNextStep3()"
                            (click)="nextStep()"
                          >
                            Suivant <i class="bi bi-arrow-right"></i>
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div
                    class="wizard-step-content"
                    *ngIf="currentStep === 4"
                    data-step="4"
                  >
                    <div class="card border-0">
                      <div class="card-header">
                        <h5 class="section-title">S√©curit√©</h5>
                        <p class="form-help">
                          Configurez 2FA, questions de s√©curit√© et r√©cup√©ration
                          d‚Äôacc√®s.
                        </p>
                      </div>
                      <div class="card-body">
                        <table class="table table-bordered">
                          <thead class="table-primary">
                            <tr>
                              <th>Option</th>
                              <th>Statut</th>
                              <th>Actions</th>
                            </tr>
                          </thead>

                          <tbody>
                            <tr *ngFor="let s of securites">
                              <td>{{ s.option }}</td>
                              <td>
                                {{
                                  s.option === "Code pin(transaction)"
                                    ? "****"
                                    : s.statut && s.statut.trim() !== ""
                                    ? s.statut
                                    : "Non configur√©"
                                }}
                              </td>
                              <td>
                                <button
                                  class="btn btn-outline-secondary"
                                  *ngIf="s.editable; else noEdit"
                                  (click)="openEditModalSecurite(s)"
                                >
                                  Configur√©
                                </button>

                                <ng-template #noEdit>
                                  <button class="btn btn-secondary" disabled>
                                    ‚úÖ
                                  </button>
                                </ng-template>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                      <div class="card-footer">
                        <div class="d-flex justify-content-between mt-4">
                          <button
                            class="btn btn-outline-secondary hover-animate"
                            (click)="prevStep()"
                          >
                            <i class="bi bi-arrow-left"></i> Pr√©c√©dent
                          </button>
                          <button
                            class="btn btn-primary hover-animate"
                            [disabled]="!canGoNextStep4()"
                            (click)="nextStep(); saveSecuriteToLocalStorage()"
                          >
                            Suivant
                            <i class="bi bi-arrow-right"></i>
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>

                  <dialog id="modifierSecuriteModalCode" class="dialog">
                    <form
                      [formGroup]="securiteFormCode"
                      (ngSubmit)="saveSecuriteCode()"
                    >
                      <div class="mb-3">
                        <label>Code PIN</label>
                        <input
                          type="text"
                          class="form-control"
                          formControlName="codePin"
                          placeholder="Entrez votre code PIN"
                          maxlength="4"
                          (keypress)="onlyNumber($event)"
                        />

                        <div
                          *ngIf="codePin?.touched && codePin?.invalid"
                          class="text-danger"
                        >
                          <div *ngIf="codePin?.errors?.['required']">
                            Veuillez remplir le code PIN.
                          </div>
                        </div>
                      </div>

                      <div class="mt-3">
                        <button
                          type="submit"
                          class="btn btn-primary me-2"
                          [disabled]="securiteFormCode.invalid"
                        >
                          Enregistrer
                        </button>
                        <button
                          type="button"
                          class="btn btn-secondary"
                          (click)="closeModalSecuriteCode()"
                        >
                          Annuler
                        </button>
                      </div>
                    </form>
                  </dialog>

                  <dialog
                    id="modifierSecuriteModalRecupererAcces"
                    class="dialog"
                  >
                    <form
                      [formGroup]="securiteFormRecuperation"
                      (ngSubmit)="saveSecuriteFormRecuperation()"
                    >
                      <div class="mb-3">
                        <label>Email</label>
                        <input
                          type="email"
                          class="form-control"
                          formControlName="email"
                          placeholder="Entrez votre email"
                        />
                        <div
                          *ngIf="email?.touched && email?.invalid"
                          class="text-danger"
                        >
                          <div *ngIf="email?.errors?.['required']">
                            Veuillez remplir l'email.
                          </div>
                          <div *ngIf="email?.errors?.['email']">
                            Veuillez entrer un email valide.
                          </div>
                        </div>
                      </div>

                      <div class="mt-3">
                        <button
                          type="submit"
                          class="btn btn-primary me-2"
                          [disabled]="securiteFormRecuperation.invalid"
                        >
                          Enregistrer
                        </button>
                        <button
                          type="button"
                          class="btn btn-secondary"
                          (click)="closeModalSecuriteRecu()"
                        >
                          Annuler
                        </button>
                      </div>
                    </form>
                  </dialog>

                  <dialog id="modifierSecuriteModal" class="dialog">
                    <form
                      [formGroup]="securiteForm"
                      (ngSubmit)="saveSecuriteQuestionsSecurite()"
                    >
                      <div class="mb-3" *ngFor="let q of listesQuestions">
                        <label>{{ q.vcQuestion }}</label>
                        <input
                          class="form-control"
                          [formControlName]="q.controlName"
                        />
                        <div
                          *ngIf="
                            securiteForm.get(q.controlName)?.touched &&
                            securiteForm.get(q.controlName)?.invalid
                          "
                          class="text-danger"
                        >
                          Veuillez remplir cette question.
                        </div>
                      </div>

                      <div class="mt-3">
                        <button
                          type="submit"
                          class="btn btn-primary me-2"
                          [disabled]="securiteForm.invalid"
                        >
                          Enregistrer
                        </button>
                        <button
                          type="button"
                          class="btn btn-secondary"
                          (click)="closeModalSecurite()"
                        >
                          Annuler
                        </button>
                      </div>
                    </form>
                  </dialog>

                  <div
                    class="wizard-step-content"
                    *ngIf="currentStep === 5"
                    data-step="5"
                  >
                    <div class="card border-0">
                      <div class="card-header">
                        <h5 class="section-title">
                          Avez-vous une organisation?
                        </h5>
                      </div>
                      <div class="card-body">
                        <div class="form-check form-check-inline mb-3">
                          <input
                            type="radio"
                            class="form-check-input"
                            id="multiYes"
                            name="lien"
                            [value]="true"
                            [(ngModel)]="validationConfiguredLien"
                          />
                          <label class="form-check-label" for="multiYes"
                            >Oui</label
                          >
                        </div>
                        <div class="form-check form-check-inline mb-3">
                          <input
                            type="radio"
                            class="form-check-input"
                            id="multiNo"
                            name="lien"
                            value="no"
                            [(ngModel)]="validationConfiguredLien"
                            [value]="false"
                            checked
                          />
                          <label class="form-check-label" for="multiNo"
                            >Non</label
                          >
                        </div>
                        <div
                          *ngIf="validationConfiguredLien"
                          id="validationConfig"
                        >
                          <div class="container mt-4">
                            <h4>Ajouter le lien de votre organisation</h4>

                            <div class="mb-3">
                              <!-- <input
                                type="url"
                                class="form-control"
                                id="lien"
                                placeholder="Exemple: http://societegeneralguinee.com"
                                required
                                [(ngModel)]="lienSaisi"
                              /> -->
                              <!-- <span class="input-group-text">https://</span> -->
                              <!-- lien.component.html -->
                              <div class="input-group">
                                <!-- indicatif gris√© -->
                                <span class="input-group-text">https://</span>

                                <!-- input pour la partie modifiable -->
                                <input
                                  type="text"
                                  class="form-control"
                                  placeholder="exemple.com"
                                  [(ngModel)]="lienSaisi"
                                  (input)="formatLien()"
                                />
                              </div>
                            </div>

                            <!-- <button class="btn btn-primary">Enregistrer</button> -->
                          </div>

                          <dialog id="niveauModal" class="dialog">
                            <form
                              [formGroup]="niveauForm"
                              (ngSubmit)="saveNiveau()"
                            >
                              <div class="mb-3">
                                <label>R√¥le</label>
                                <select
                                  formControlName="vcRoleName"
                                  class="form-control"
                                >
                                  <option value="">
                                    -- S√©lectionner un r√¥le --
                                  </option>
                                  <option
                                    *ngFor="let role of listeRoleNiveau"
                                    [value]="role.id"
                                  >
                                    {{ role.vcRoleName }}
                                  </option>
                                </select>
                                <!-- Message d'erreur -->
                                <div
                                  *ngIf="
                                    niveauForm.get('vcRoleName')?.touched &&
                                    niveauForm.get('vcRoleName')?.invalid
                                  "
                                  class="text-danger"
                                >
                                  Veuillez s√©lectionner un r√¥le.
                                </div>
                              </div>

                              <div class="mb-3">
                                <label>Plafond financier (GNF)</label>
                                <div class="d-flex">
                                  <input
                                    type="number"
                                    formControlName="min"
                                    class="form-control me-2"
                                    placeholder="Min"
                                  />
                                  <input
                                    type="number"
                                    formControlName="max"
                                    class="form-control"
                                    placeholder="Max"
                                  />
                                </div>
                                <div
                                  *ngIf="
                                    niveauForm.get('min')?.touched &&
                                    niveauForm.get('min')?.invalid
                                  "
                                  class="text-danger"
                                >
                                  Veuillez saisir un montant minimum valide.
                                </div>
                                <div
                                  *ngIf="
                                    niveauForm.get('max')?.touched &&
                                    niveauForm.get('max')?.invalid
                                  "
                                  class="text-danger"
                                >
                                  Veuillez saisir un montant maximum valide.
                                </div>
                              </div>

                              <div class="mt-3">
                                <button
                                  type="submit"
                                  class="btn btn-primary me-2"
                                  [disabled]="niveauForm.invalid"
                                >
                                  Enregistrer
                                </button>
                                <button
                                  type="button"
                                  class="btn btn-secondary"
                                  (click)="closeModal()"
                                >
                                  Annuler
                                </button>
                              </div>
                            </form>
                          </dialog>
                        </div>
                      </div>
                      <div class="card-footer">
                        <div class="d-flex justify-content-between mt-4">
                          <button
                            class="btn btn-outline-secondary hover-animate"
                            (click)="prevStep()"
                          >
                            <i class="bi bi-arrow-left"></i> Pr√©c√©dent
                          </button>
                          <button
                            class="btn btn-primary hover-animate"
                            [disabled]="!canGoNextStep5()"
                            (click)="nextStep(); verifieLienOrganisation()"
                          >
                            {{
                              loadingLienOrganisation
                                ? "Verification en cours"
                                : "Suivant"
                            }}
                            <i class="bi bi-arrow-right"></i>
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div
                    class="wizard-step-content"
                    *ngIf="currentStep === 6"
                    data-step="6"
                  >
                    <div class="card border-0">
                      <div class="card-header">
                        <h5 class="section-title">R√©sum√©</h5>
                        <p class="form-help">
                          V√©rifiez les param√®tres avant de valider.
                        </p>
                      </div>
                      <div class="card-body">
                        <table class="table table-bordered">
                          <thead class="table-primary">
                            <tr>
                              <th>Section</th>
                              <th>Statut</th>
                              <th>Actions</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr *ngFor="let resume of resumes">
                              <td>{{ resume.Section }}</td>
                              <td>{{ resume.Statut }}</td>

                              <td>
                                <ng-container [ngSwitch]="resume.Section">
                                  <ng-container
                                    *ngSwitchCase="'Comptes Bancaires'"
                                  >
                                    <!-- <button
                                      class="btn btn-light btn-sm hover-animate me-2"
                                      (click)="goToStep(1)"
                                    >
                                      <i class="bi bi-eye"></i> Voir
                                    </button> -->
                                    <button
                                      class="btn btn-light btn-sm hover-animate"
                                      (click)="goToStep(1)"
                                    >
                                      <i class="bi bi-pencil-square"></i>
                                      Modifier
                                    </button>
                                  </ng-container>

                                  <!-- Si section est "Validation Multi-Niveaux" -->
                                  <ng-container
                                    *ngSwitchCase="'Validation Multi-Niveaux'"
                                  >
                                    <!-- <button
                                      class="btn btn-light btn-sm hover-animate me-2"
                                      (click)="goToStep(2)"
                                    >
                                      <i class="bi bi-eye"></i> Voir
                                    </button> -->
                                    <button
                                      class="btn btn-light btn-sm hover-animate"
                                      (click)="goToStep(2)"
                                    >
                                      <i class="bi bi-pencil-square"></i>
                                      Modifier
                                    </button>
                                  </ng-container>

                                  <!-- Si section est "Cat√©gories" -->
                                  <ng-container *ngSwitchCase="'Cat√©gories'">
                                    <!-- <button
                                      class="btn btn-light btn-sm hover-animate me-2"
                                      (click)="goToStep(3)"
                                    >
                                      <i class="bi bi-eye"></i> Voir
                                    </button> -->
                                    <button
                                      class="btn btn-light btn-sm hover-animate"
                                      (click)="goToStep(3)"
                                    >
                                      <i class="bi bi-pencil-square"></i>
                                      Modifier
                                    </button>
                                  </ng-container>

                                  <!-- Si section est "S√©curit√©" -->
                                  <ng-container *ngSwitchCase="'S√©curit√©'">
                                    <!-- <button
                                      class="btn btn-light btn-sm hover-animate me-2"
                                      (click)="goToStep(4)"
                                    >
                                      <i class="bi bi-eye"></i> Voir
                                    </button> -->
                                    <button
                                      class="btn btn-light btn-sm hover-animate"
                                      (click)="goToStep(4)"
                                    >
                                      <i class="bi bi-pencil-square"></i>
                                      Modifier
                                    </button>
                                  </ng-container>

                                  <!-- Si section est "Lien" -->
                                  <ng-container *ngSwitchCase="'Organisation'">
                                    <!-- <button
                                      class="btn btn-light btn-sm hover-animate me-2"
                                      (click)="goToStep(5)"
                                    >
                                      <i class="bi bi-eye"></i> Voir
                                    </button> -->
                                    <button
                                      class="btn btn-light btn-sm hover-animate"
                                      (click)="goToStep(5)"
                                    >
                                      <i class="bi bi-pencil-square"></i>
                                      Modifier
                                    </button>
                                  </ng-container>
                                </ng-container>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                      <div class="card-footer">
                        <div class="d-flex justify-content-between mt-4">
                          <button
                            class="btn btn-outline-secondary hover-animate"
                            (click)="prevStep()"
                          >
                            <i class="bi bi-arrow-left"> </i>
                            Pr√©c√©dent
                          </button>
                          <button
                            class="btn btn-primary hover-animate"
                            [disabled]="loadingFinal"
                            (click)="addSouscriptionClient()"
                          >
                            {{
                              loadingFinal
                                ? "Finilisation en cours..."
                                : "Finaliser et Activer"
                            }}
                            <i class="bi bi-arrow-right"></i>
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="text-center mt-4 mt-md-5">
                <p>
                  <span> ¬©&nbsp;</span>
                  <script>
                    document.write(new Date().getFullYear());
                  </script>
                  <span>&nbsp; BCI-Online.</span
                  ><span class="ms-2">Powered</span
                  ><i class="icon ion-heart text-danger mx-1"></i
                  ><span>by&nbsp;<a href="#">MV1</a></span>
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div
  class="modal fade"
  role="dialog"
  tabindex="-1"
  id="finaliserActiverModal"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5>Finaliser et Activer</h5>
        <button
          class="btn-close"
          aria-label="Fermer"
          data-bs-dismiss="modal"
          type="button"
        ></button>
      </div>
      <div class="modal-body">
        <span class="fw-semibold">
          √ätes-vous s√ªr de vouloir finaliser et activer vos configurations ?
        </span>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">
          Annuler
        </button>
        <button
          class="btn btn-primary"
          data-bs-toggle="modal"
          data-bs-target="#confirmFinaliserBtn"
        >
          Confirmer
        </button>
      </div>
    </div>
  </div>
</div>

<div
  class="modal fade"
  role="dialog"
  tabindex="-1"
  id="confirmFinaliserBtn"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5>Configurations Finalis√©es</h5>
        <button
          class="btn-close"
          aria-label="Fermer"
          data-bs-dismiss="modal"
          type="button"
        ></button>
      </div>
      <div class="modal-body">
        <span class="fw-semibold">
          Vos configurations ont √©t√© activ√©es avec succ√®s.
        </span>
      </div>
      <div class="modal-footer">
        <a
          class="btn btn-primary"
          role="button"
          data-bs-dismiss="modal"
          routerLink="/dashboard"
          >Tableau de Bord</a
        >
      </div>
    </div>
  </div>
</div>

<div
  class="modal fade"
  role="dialog"
  tabindex="-1"
  id="confirmRetraitCompteModal"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5>Confirmer le retrait du compte</h5>
        <button
          class="btn-close"
          aria-label="Fermer"
          data-bs-dismiss="modal"
        ></button>
      </div>
      <div class="modal-body">
        <span class="fw-semibold">
          √ätes-vous s√ªr de vouloir retirer ce compte ?
        </span>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">
          Annuler</button
        ><button class="btn btn-danger" id="confirmRetraitBtn">
          Confirmer
        </button>
      </div>
    </div>
  </div>
</div>
<div
  class="modal fade"
  role="dialog"
  tabindex="-1"
  id="successSaveComptesModal"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5>S√©lection sauvegard√©e</h5>
        <button
          class="btn-close"
          aria-label="Fermer"
          data-bs-dismiss="modal"
          type="button"
        ></button>
      </div>
      <div class="modal-body">
        <span class="fw-semibold">
          Vos comptes s√©lectionn√©s ont √©t√© enregistr√©s avec succ√®s.
        </span>
      </div>
      <div class="modal-footer">
        <button class="btn btn-primary" data-bs-dismiss="modal">OK</button>
      </div>
    </div>
  </div>
</div>
<div
  class="modal fade"
  role="dialog"
  tabindex="-1"
  id="addNiveauModal"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5>Ajouter un Niveau</h5>
        <button
          class="btn-close"
          aria-label="Fermer"
          data-bs-dismiss="modal"
          type="button"
        ></button>
      </div>
      <div class="modal-body">
        <div class="mb-3">
          <label class="form-label fw-semibold">R√¥le</label
          ><select class="form-select" id="addNiveauRole">
            <option value="">Comptable</option>
            <option value="">Chef Comptable</option>
            <option value="">DAF</option>
          </select>
        </div>
        <div class="mb-3">
          <label class="form-label fw-semibold">Plafond financier (GNF)</label>
          <div class="d-flex">
            <input
              type="number"
              class="form-control me-2"
              id="addNiveauDebut"
              placeholder="D√©but"
              value="0"
            /><input
              type="number"
              class="form-control"
              id="addNiveauFin"
              placeholder="Fin"
              value="50000000"
            />
          </div>
        </div>
        <div class="mb-3">
          <label class="form-label fw-semibold">R√®gle d‚Äôapprobation</label>
          <div class="form-check">
            <input
              type="radio"
              checked=""
              class="form-check-input"
              name="regleApproAdd"
              value="un"
            /><label class="form-check-label">Un seul validateur</label>
          </div>
          <div class="form-check">
            <input
              type="radio"
              class="form-check-input"
              name="regleApproAdd"
              value="tous"
            /><label class="form-check-label">Tous les validateurs</label>
          </div>
        </div>
        <div class="warning-text" id="addNiveauWarning" style="display: none">
          <span>Veuillez remplir tous les champs.</span>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">
          Annuler</button
        ><button class="btn btn-primary" id="addNiveauBtn">Ajouter</button>
      </div>
    </div>
  </div>
</div>
<div
  class="modal fade"
  role="dialog"
  tabindex="-1"
  id="editNiveauModal"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5>Modifier le Niveau</h5>
        <button
          class="btn-close"
          aria-label="Fermer"
          data-bs-dismiss="modal"
          type="button"
        ></button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="editNiveauIndex" />
        <div class="mb-3">
          <label class="form-label fw-semibold">R√¥le</label
          ><select class="form-select" id="editNiveauRole">
            <option value="">Comptable</option>
            <option value="">Chef Comptable</option>
            <option value="">DAF</option>
          </select>
        </div>
        <div class="mb-3">
          <label class="form-label fw-semibold">Plafond financier (GNF)</label>
          <div class="d-flex">
            <input
              type="number"
              class="form-control me-2"
              id="editNiveauDebut"
            /><input type="number" class="form-control" id="editNiveauFin" />
          </div>
        </div>
        <div class="mb-3">
          <label class="form-label fw-semibold">R√®gle d‚Äôapprobation</label>
          <div class="form-check">
            <input
              type="radio"
              class="form-check-input"
              name="regleApproEdit"
              value="un"
            /><label class="form-check-label">Un seul validateur</label>
          </div>
          <div class="form-check">
            <input
              type="radio"
              class="form-check-input"
              name="regleApproEdit"
              value="tous"
            /><label class="form-check-label">Tous les validateurs</label>
          </div>
        </div>
        <div class="warning-text" id="editNiveauWarning" style="display: none">
          <span>Veuillez remplir tous les champs.</span>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">
          Annuler</button
        ><button class="btn btn-primary" id="saveNiveauChangesBtn">
          Enregistrer
        </button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="addCategorieModal" tabindex="-1" role="dialog">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5>Ajouter / Modifier une Cat√©gorie</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Fermer"
        ></button>
      </div>
      <div class="modal-body">
        <div class="mb-3">
          <label class="form-label fw-semibold required"
            >Nom de la cat√©gorie</label
          >
          <input
            type="text"
            class="form-control"
            id="addCatNom"
            placeholder="Ex: Achats divers"
          />
        </div>
        <div class="mb-3">
          <label class="form-label fw-semibold">Description (optionnel)</label>
          <input
            type="text"
            class="form-control"
            id="addCatDesc"
            placeholder="Ex: Paiements ponctuels"
          />
        </div>

        <div class="text-danger" id="addCatWarning" style="display: none">
          Le nom de la cat√©gorie est obligatoire.
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          Annuler
        </button>
        <button type="button" class="btn btn-primary" (click)="saveCategorie()">
          Enregistrer
        </button>
      </div>
    </div>
  </div>
</div>

<div
  class="modal fade"
  role="dialog"
  tabindex="-1"
  id="viewCategorieModal"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5>D√©tails de la Cat√©gorie</h5>
        <button
          class="btn-close"
          aria-label="Fermer"
          data-bs-dismiss="modal"
          type="button"
        ></button>
      </div>
      <div class="modal-body" id="viewCatBody"></div>
      <div class="modal-footer">
        <button class="btn btn-primary" data-bs-dismiss="modal">Fermer</button>
      </div>
    </div>
  </div>
</div>
<div
  class="modal fade"
  role="dialog"
  tabindex="-1"
  id="deleteCategorieModal"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5>Confirmer la suppression</h5>
        <button
          class="btn-close"
          aria-label="Fermer"
          data-bs-dismiss="modal"
          type="button"
        ></button>
      </div>
      <div class="modal-body">
        <span class="fw-semibold">
          √ätes-vous s√ªr de vouloir supprimer cette cat√©gorie ?
        </span>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">
          Annuler</button
        ><button class="btn btn-danger" id="confirmDeleteCatBtn">
          Confirmer
        </button>
      </div>
    </div>
  </div>
</div>
<div
  class="modal fade"
  role="dialog"
  tabindex="-1"
  id="2faModal"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5>Activer/Modifier la 2FA</h5>
        <button
          class="btn-close"
          aria-label="Fermer"
          data-bs-dismiss="modal"
          type="button"
        ></button>
      </div>
      <div class="modal-body">
        <p class="fw-semibold">M√©thodes :</p>
        <div class="form-check">
          <input
            type="radio"
            checked=""
            class="form-check-input"
            name="2faMethod"
          /><label class="form-check-label">Par SMS</label>
        </div>
        <div class="form-check mb-3">
          <input type="radio" class="form-check-input" name="2faMethod" /><label
            class="form-check-label"
            >Par Application</label
          >
        </div>
        <p class="fw-semibold">Entrez le code re√ßu :</p>
        <input type="text" class="form-control mb-3" placeholder="Code OTP" />
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">
          Annuler</button
        ><button class="btn btn-primary">Activer</button>
      </div>
    </div>
  </div>
</div>
<div
  class="modal fade"
  role="dialog"
  tabindex="-1"
  id="qsModal"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5>Configurer les Questions de S√©curit√©</h5>
        <button
          class="btn-close"
          aria-label="Fermer"
          data-bs-dismiss="modal"
          type="button"
        ></button>
      </div>
      <div class="modal-body">
        <p class="fw-semibold">
          Question 1 : Quel est le nom de votre premier animal ?
        </p>
        <input type="text" class="form-control mb-3" />
        <p class="fw-semibold">
          Question 2 : Dans quelle ville √™tes-vous n√©(e) ?
        </p>
        <input type="text" class="form-control mb-3" />
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">
          Annuler</button
        ><button class="btn btn-primary">Enregistrer</button>
      </div>
    </div>
  </div>
</div>
<div
  class="modal fade"
  role="dialog"
  tabindex="-1"
  id="recupModal"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5>Configurer la R√©cup√©ration d‚ÄôAcc√®s</h5>
        <button
          class="btn-close"
          aria-label="Fermer"
          data-bs-dismiss="modal"
          type="button"
        ></button>
      </div>
      <div class="modal-body">
        <label class="form-label fw-semibold"
          >Adresse email de r√©cup√©ration</label
        ><input
          type="email"
          class="form-control mb-3"
          placeholder="ex: contact@example.com"
        />
        <p class="fw-semibold">Entrez le code re√ßu par email :</p>
        <input type="text" class="form-control mb-3" placeholder="Code OTP" />
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">
          Annuler</button
        ><button class="btn btn-primary">Enregistrer</button>
      </div>
    </div>
  </div>
</div>
<div
  class="modal fade"
  role="dialog"
  tabindex="-1"
  id="confirmFinalisationModal"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5>Finaliser et Activer</h5>
        <button
          class="btn-close"
          aria-label="Fermer"
          data-bs-dismiss="modal"
          type="button"
        ></button>
      </div>
      <div class="modal-body">
        <span class="fw-semibold">
          √ätes-vous s√ªr de vouloir finaliser et activer vos configurations ?
        </span>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">
          Annuler</button
        ><button class="btn btn-primary" id="confirmFinaliserBtn">
          Confirmer
        </button>
      </div>
    </div>
  </div>
</div>
<div
  class="modal fade"
  role="dialog"
  tabindex="-1"
  id="successFinalisationModal"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5>Configurations Finalis√©es</h5>
        <button
          class="btn-close"
          aria-label="Fermer"
          data-bs-dismiss="modal"
          type="button"
        ></button>
      </div>
      <div class="modal-body">
        <span class="fw-semibold">
          Vos configurations ont √©t√© activ√©es avec succ√®s.
        </span>
      </div>
      <div class="modal-footer">
        <a
          class="btn btn-primary"
          role="button"
          data-bs-dismiss="modal"
          href="index.html"
          >Tableau de Bord</a
        >
      </div>
    </div>
  </div>
</div>
